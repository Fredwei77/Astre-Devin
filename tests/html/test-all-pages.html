<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨é¡µé¢æµ‹è¯• - Destiny AI</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 { color: #333; margin-bottom: 30px; }
        .page-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .page-title {
            font-size: 20px;
            font-weight: bold;
            color: #4CAF50;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #4CAF50;
        }
        .test-item {
            padding: 10px;
            margin: 5px 0;
            border-left: 4px solid #ddd;
            background: #f9f9f9;
        }
        .success { border-left-color: #4CAF50; }
        .warning { border-left-color: #ff9800; background: #fff3e0; }
        .error { border-left-color: #f44336; background: #ffebee; }
        button {
            background: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover { background: #45a049; }
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        .stat-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #4CAF50;
        }
        .stat-label {
            color: #666;
            margin-top: 5px;
        }
        iframe {
            width: 100%;
            height: 600px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª å…¨é¡µé¢æµ‹è¯•å·¥å…·</h1>
    
    <div class="stats">
        <div class="stat-box">
            <div class="stat-number" id="totalPages">0</div>
            <div class="stat-label">æ€»é¡µé¢æ•°</div>
        </div>
        <div class="stat-box">
            <div class="stat-number" id="testedPages">0</div>
            <div class="stat-label">å·²æµ‹è¯•</div>
        </div>
        <div class="stat-box">
            <div class="stat-number" id="passedPages">0</div>
            <div class="stat-label">é€šè¿‡</div>
        </div>
        <div class="stat-box">
            <div class="stat-number" id="failedPages">0</div>
            <div class="stat-label">å¤±è´¥</div>
        </div>
    </div>
    
    <div>
        <button onclick="testAllPages()">æµ‹è¯•æ‰€æœ‰é¡µé¢</button>
        <button onclick="testTranslations()">æµ‹è¯•ç¿»è¯‘</button>
        <button onclick="clearResults()">æ¸…ç©ºç»“æœ</button>
    </div>
    
    <div id="results"></div>
    
    <script>
        const pages = [
            { name: 'é¦–é¡µ', url: 'index.html', key: 'home' },
            { name: 'å åœé¡µé¢', url: 'divination.html', key: 'divination' },
            { name: 'é£æ°´é¡µé¢', url: 'fengshui.html', key: 'fengshui' },
            { name: 'æ˜“ç»é¡µé¢', url: 'iching.html', key: 'iching' },
            { name: 'ä¸ªäººæ¡£æ¡ˆ', url: 'profile.html', key: 'profile' },
            { name: 'æ”¯ä»˜é¡µé¢', url: 'payment.html', key: 'payment' },
            { name: 'éšç§æ”¿ç­–', url: 'privacy.html', key: 'privacy' },
            { name: 'æœåŠ¡æ¡æ¬¾', url: 'terms.html', key: 'terms' }
        ];
        
        let stats = {
            total: pages.length,
            tested: 0,
            passed: 0,
            failed: 0
        };
        
        function updateStats() {
            document.getElementById('totalPages').textContent = stats.total;
            document.getElementById('testedPages').textContent = stats.tested;
            document.getElementById('passedPages').textContent = stats.passed;
            document.getElementById('failedPages').textContent = stats.failed;
        }
        
        async function testAllPages() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = '<div class="page-section"><div class="page-title">æ­£åœ¨æµ‹è¯•...</div></div>';
            
            stats = { total: pages.length, tested: 0, passed: 0, failed: 0 };
            updateStats();
            
            for (const page of pages) {
                await testPage(page);
                stats.tested++;
                updateStats();
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            resultsDiv.innerHTML += `
                <div class="page-section">
                    <div class="page-title">âœ… æµ‹è¯•å®Œæˆï¼</div>
                    <div class="test-item success">
                        æ€»è®¡: ${stats.total} é¡µé¢<br>
                        é€šè¿‡: ${stats.passed} é¡µé¢<br>
                        å¤±è´¥: ${stats.failed} é¡µé¢<br>
                        æˆåŠŸç‡: ${Math.round(stats.passed / stats.total * 100)}%
                    </div>
                </div>
            `;
        }
        
        async function testPage(page) {
            const resultsDiv = document.getElementById('results');
            const section = document.createElement('div');
            section.className = 'page-section';
            section.innerHTML = `<div class="page-title">ğŸ“„ ${page.name} (${page.url})</div>`;
            
            try {
                // æµ‹è¯•é¡µé¢æ˜¯å¦å¯è®¿é—®
                const response = await fetch(page.url);
                
                if (response.ok) {
                    const html = await response.text();
                    
                    // æ£€æŸ¥å…³é”®å…ƒç´ 
                    const checks = [
                        { name: 'é¡µé¢åŠ è½½', test: html.length > 0 },
                        { name: 'HTMLç»“æ„', test: html.includes('<!DOCTYPE html>') },
                        { name: 'è¯­è¨€åˆ‡æ¢å™¨', test: html.includes('language-switcher') || html.includes('i18n') },
                        { name: 'ç¿»è¯‘æ ‡ç­¾', test: html.includes('data-i18n') },
                        { name: 'Config.js', test: html.includes('config.js') },
                        { name: 'AI Service', test: html.includes('ai-service.js') || !page.url.includes('divination') }
                    ];
                    
                    let allPassed = true;
                    checks.forEach(check => {
                        const status = check.test ? 'âœ…' : 'âŒ';
                        const className = check.test ? 'success' : 'error';
                        section.innerHTML += `<div class="test-item ${className}">${status} ${check.name}</div>`;
                        if (!check.test) allPassed = false;
                    });
                    
                    // æ£€æŸ¥ç¿»è¯‘è¦†ç›–
                    const i18nMatches = html.match(/data-i18n="[^"]+"/g);
                    if (i18nMatches) {
                        section.innerHTML += `<div class="test-item success">âœ… æ‰¾åˆ° ${i18nMatches.length} ä¸ªç¿»è¯‘æ ‡ç­¾</div>`;
                    } else {
                        section.innerHTML += `<div class="test-item warning">âš ï¸ æœªæ‰¾åˆ°ç¿»è¯‘æ ‡ç­¾</div>`;
                    }
                    
                    if (allPassed) {
                        stats.passed++;
                        section.innerHTML += `<div class="test-item success"><strong>âœ… é¡µé¢æµ‹è¯•é€šè¿‡</strong></div>`;
                    } else {
                        stats.failed++;
                        section.innerHTML += `<div class="test-item error"><strong>âŒ é¡µé¢æµ‹è¯•å¤±è´¥</strong></div>`;
                    }
                    
                } else {
                    stats.failed++;
                    section.innerHTML += `<div class="test-item error">âŒ é¡µé¢æ— æ³•è®¿é—® (${response.status})</div>`;
                }
                
            } catch (error) {
                stats.failed++;
                section.innerHTML += `<div class="test-item error">âŒ é”™è¯¯: ${error.message}</div>`;
            }
            
            resultsDiv.appendChild(section);
        }
        
        function testTranslations() {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `
                <div class="page-section">
                    <div class="page-title">ğŸŒ ç¿»è¯‘æµ‹è¯•</div>
                    <div class="test-item success">
                        <strong>æµ‹è¯•æ–¹æ³•ï¼š</strong><br>
                        1. æ‰“å¼€ä»»æ„é¡µé¢<br>
                        2. ç‚¹å‡»å³ä¸Šè§’çš„è¯­è¨€åˆ‡æ¢å™¨<br>
                        3. åˆ‡æ¢åˆ°"ç®€ä½“ä¸­æ–‡"æˆ–"ç¹é«”ä¸­æ–‡"<br>
                        4. æ£€æŸ¥é¡µé¢æ–‡æœ¬æ˜¯å¦æ­£ç¡®ç¿»è¯‘
                    </div>
                    <div class="test-item warning">
                        <strong>å¸¸è§é—®é¢˜ï¼š</strong><br>
                        â€¢ å¦‚æœç¿»è¯‘æœªç”Ÿæ•ˆï¼Œè¯·åˆ·æ–°é¡µé¢ (Ctrl+F5)<br>
                        â€¢ æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯<br>
                        â€¢ ç¡®è®¤ language-switcher-final.js å·²åŠ è½½
                    </div>
                    <iframe src="index.html"></iframe>
                </div>
            `;
        }
        
        function clearResults() {
            document.getElementById('results').innerHTML = '';
            stats = { total: pages.length, tested: 0, passed: 0, failed: 0 };
            updateStats();
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', () => {
            updateStats();
        });
    </script>
</body>
</html>
