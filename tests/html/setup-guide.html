<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¹ç­® - APIé…ç½®å‘å¯¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); }
        .glass { background: rgba(26, 26, 46, 0.9); backdrop-filter: blur(15px); }
        .gold { color: #daa520; }
        .gold-bg { background: linear-gradient(135deg, #daa520, #e6b82a); }
    </style>
</head>
<body class="min-h-screen text-white">
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- Header -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold gold mb-4">
                    <i class="fas fa-cog mr-3"></i>ä¹ç­® APIé…ç½®å‘å¯¼
                </h1>
                <p class="text-gray-300">å®Œæˆä»¥ä¸‹é…ç½®ï¼Œå¯ç”¨å®Œæ•´çš„ç”¨æˆ·è®¤è¯åŠŸèƒ½</p>
            </div>

            <!-- Progress Steps -->
            <div class="flex justify-between mb-8">
                <div class="step active flex flex-col items-center">
                    <div class="w-10 h-10 rounded-full gold-bg flex items-center justify-center text-black font-bold mb-2">1</div>
                    <span class="text-sm">åç«¯API</span>
                </div>
                <div class="step flex flex-col items-center">
                    <div class="w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center text-white font-bold mb-2">2</div>
                    <span class="text-sm">Google OAuth</span>
                </div>
                <div class="step flex flex-col items-center">
                    <div class="w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center text-white font-bold mb-2">3</div>
                    <span class="text-sm">GitHub OAuth</span>
                </div>
                <div class="step flex flex-col items-center">
                    <div class="w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center text-white font-bold mb-2">4</div>
                    <span class="text-sm">å®Œæˆ</span>
                </div>
            </div>

            <!-- Step 1: Backend API -->
            <div id="step1" class="step-content glass rounded-2xl p-8 border border-yellow-500/30">
                <h2 class="text-2xl font-bold gold mb-6">
                    <i class="fas fa-server mr-3"></i>æ­¥éª¤ 1: é…ç½®åç«¯API
                </h2>
                
                <div class="space-y-6">
                    <div class="bg-blue-500/20 border border-blue-500/30 rounded-lg p-4">
                        <h3 class="font-bold text-blue-300 mb-2">ğŸ“‹ åç«¯APIè¦æ±‚</h3>
                        <p class="text-gray-300 text-sm mb-3">æ‚¨çš„åç«¯APIéœ€è¦æ”¯æŒä»¥ä¸‹ç«¯ç‚¹ï¼š</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                            <div>
                                <strong class="gold">è®¤è¯ç«¯ç‚¹:</strong>
                                <ul class="list-disc list-inside text-gray-400 mt-1">
                                    <li>POST /api/v1/auth/login</li>
                                    <li>POST /api/v1/auth/register</li>
                                    <li>POST /api/v1/auth/logout</li>
                                    <li>POST /api/v1/auth/forgot-password</li>
                                    <li>POST /api/v1/auth/refresh</li>
                                </ul>
                            </div>
                            <div>
                                <strong class="gold">ç”¨æˆ·ç«¯ç‚¹:</strong>
                                <ul class="list-disc list-inside text-gray-400 mt-1">
                                    <li>GET /api/v1/user/profile</li>
                                    <li>PUT /api/v1/user/update</li>
                                    <li>POST /api/v1/user/upload-avatar</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div>
                        <label class="block text-gray-300 font-medium mb-2">
                            <i class="fas fa-link mr-2"></i>APIåŸºç¡€URL
                        </label>
                        <input type="url" id="apiUrl" 
                               class="w-full p-3 bg-black/50 border border-gray-500 rounded-lg text-white placeholder-gray-400 focus:border-yellow-500 focus:outline-none"
                               placeholder="https://api.jiushiai.com" 
                               value="https://api.jiushiai.com">
                        <p class="text-sm text-gray-400 mt-1">è¾“å…¥æ‚¨çš„åç«¯APIåŸºç¡€URLåœ°å€</p>
                    </div>

                    <div class="bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4">
                        <h3 class="font-bold text-yellow-300 mb-2">âš ï¸ å¼€å‘æ¨¡å¼è¯´æ˜</h3>
                        <p class="text-gray-300 text-sm">
                            å½“æ£€æµ‹åˆ°æœ¬åœ°å¼€å‘ç¯å¢ƒæ—¶ï¼ˆlocalhost/127.0.0.1ï¼‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨æ¨¡æ‹ŸAPIï¼Œ
                            æ— éœ€çœŸå®åç«¯å³å¯æµ‹è¯•æ‰€æœ‰åŠŸèƒ½ã€‚
                        </p>
                    </div>

                    <button onclick="nextStep()" class="w-full gold-bg text-black font-bold py-3 rounded-lg hover:opacity-90 transition-opacity">
                        ä¸‹ä¸€æ­¥ï¼šé…ç½® Google OAuth
                    </button>
                </div>
            </div>

            <!-- Step 2: Google OAuth -->
            <div id="step2" class="step-content glass rounded-2xl p-8 border border-yellow-500/30 hidden">
                <h2 class="text-2xl font-bold gold mb-6">
                    <i class="fab fa-google mr-3"></i>æ­¥éª¤ 2: é…ç½® Google OAuth
                </h2>
                
                <div class="space-y-6">
                    <div class="bg-blue-500/20 border border-blue-500/30 rounded-lg p-4">
                        <h3 class="font-bold text-blue-300 mb-2">ğŸ“‹ è®¾ç½®æ­¥éª¤</h3>
                        <ol class="list-decimal list-inside text-gray-300 text-sm space-y-1">
                            <li>è®¿é—® <a href="https://console.developers.google.com" target="_blank" class="gold hover:underline">Google Cloud Console</a></li>
                            <li>åˆ›å»ºæ–°é¡¹ç›®æˆ–é€‰æ‹©ç°æœ‰é¡¹ç›®</li>
                            <li>å¯ç”¨ Google+ API å’Œ Google OAuth2 API</li>
                            <li>åˆ›å»º OAuth 2.0 å®¢æˆ·ç«¯ID</li>
                            <li>å°†å›è°ƒURLè®¾ç½®ä¸ºï¼š<code class="bg-black/30 px-2 py-1 rounded text-yellow-300">${window.location.origin}/auth/google/callback</code></li>
                            <li>å¤åˆ¶å®¢æˆ·ç«¯IDåˆ°ä¸‹æ–¹è¾“å…¥æ¡†</li>
                        </ol>
                    </div>

                    <div>
                        <label class="block text-gray-300 font-medium mb-2">
                            <i class="fab fa-google mr-2"></i>Google Client ID
                        </label>
                        <input type="text" id="googleClientId" 
                               class="w-full p-3 bg-black/50 border border-gray-500 rounded-lg text-white placeholder-gray-400 focus:border-yellow-500 focus:outline-none"
                               placeholder="123456789-abcdefg.apps.googleusercontent.com">
                        <p class="text-sm text-gray-400 mt-1">ä» Google Cloud Console è·å–çš„å®¢æˆ·ç«¯ID</p>
                    </div>

                    <div class="flex space-x-4">
                        <button onclick="prevStep()" class="flex-1 bg-gray-600 text-white font-bold py-3 rounded-lg hover:bg-gray-700 transition-colors">
                            ä¸Šä¸€æ­¥
                        </button>
                        <button onclick="nextStep()" class="flex-1 gold-bg text-black font-bold py-3 rounded-lg hover:opacity-90 transition-opacity">
                            ä¸‹ä¸€æ­¥ï¼šé…ç½® GitHub OAuth
                        </button>
                    </div>
                </div>
            </div>

            <!-- Step 3: GitHub OAuth -->
            <div id="step3" class="step-content glass rounded-2xl p-8 border border-yellow-500/30 hidden">
                <h2 class="text-2xl font-bold gold mb-6">
                    <i class="fab fa-github mr-3"></i>æ­¥éª¤ 3: é…ç½® GitHub OAuth
                </h2>
                
                <div class="space-y-6">
                    <div class="bg-blue-500/20 border border-blue-500/30 rounded-lg p-4">
                        <h3 class="font-bold text-blue-300 mb-2">ğŸ“‹ è®¾ç½®æ­¥éª¤</h3>
                        <ol class="list-decimal list-inside text-gray-300 text-sm space-y-1">
                            <li>è®¿é—® <a href="https://github.com/settings/applications/new" target="_blank" class="gold hover:underline">GitHub Developer Settings</a></li>
                            <li>ç‚¹å‡» "New OAuth App"</li>
                            <li>å¡«å†™åº”ç”¨ä¿¡æ¯ï¼š
                                <ul class="list-disc list-inside ml-4 mt-1">
                                    <li>Application name: ä¹ç­®</li>
                                    <li>Homepage URL: <code class="bg-black/30 px-1 rounded text-yellow-300">${window.location.origin}</code></li>
                                    <li>Authorization callback URL: <code class="bg-black/30 px-1 rounded text-yellow-300">${window.location.origin}/auth/github/callback</code></li>
                                </ul>
                            </li>
                            <li>åˆ›å»ºåº”ç”¨åå¤åˆ¶ Client ID</li>
                        </ol>
                    </div>

                    <div>
                        <label class="block text-gray-300 font-medium mb-2">
                            <i class="fab fa-github mr-2"></i>GitHub Client ID
                        </label>
                        <input type="text" id="githubClientId" 
                               class="w-full p-3 bg-black/50 border border-gray-500 rounded-lg text-white placeholder-gray-400 focus:border-yellow-500 focus:outline-none"
                               placeholder="abcdef1234567890">
                        <p class="text-sm text-gray-400 mt-1">ä» GitHub OAuth Apps è·å–çš„å®¢æˆ·ç«¯ID</p>
                    </div>

                    <div class="flex space-x-4">
                        <button onclick="prevStep()" class="flex-1 bg-gray-600 text-white font-bold py-3 rounded-lg hover:bg-gray-700 transition-colors">
                            ä¸Šä¸€æ­¥
                        </button>
                        <button onclick="nextStep()" class="flex-1 gold-bg text-black font-bold py-3 rounded-lg hover:opacity-90 transition-opacity">
                            å®Œæˆé…ç½®
                        </button>
                    </div>
                </div>
            </div>

            <!-- Step 4: Complete -->
            <div id="step4" class="step-content glass rounded-2xl p-8 border border-yellow-500/30 hidden">
                <h2 class="text-2xl font-bold gold mb-6">
                    <i class="fas fa-check-circle mr-3"></i>é…ç½®å®Œæˆï¼
                </h2>
                
                <div class="space-y-6">
                    <div class="bg-green-500/20 border border-green-500/30 rounded-lg p-4">
                        <h3 class="font-bold text-green-300 mb-2">ğŸ‰ æ­å–œï¼é…ç½®å·²å®Œæˆ</h3>
                        <p class="text-gray-300 text-sm">
                            æ‚¨çš„ä¹ç­®ç½‘ç«™ç°åœ¨å·²ç»å®Œå…¨é…ç½®å¥½äº†ç”¨æˆ·è®¤è¯åŠŸèƒ½ã€‚
                            é…ç½®ä¿¡æ¯å·²è‡ªåŠ¨ä¿å­˜ï¼Œæ‚¨å¯ä»¥å¼€å§‹ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½äº†ï¼
                        </p>
                    </div>

                    <div class="bg-blue-500/20 border border-blue-500/30 rounded-lg p-4">
                        <h3 class="font-bold text-blue-300 mb-3">ğŸ“ é…ç½®æ‘˜è¦</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-400">APIåœ°å€:</span>
                                <span class="gold" id="summaryApiUrl">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">Google OAuth:</span>
                                <span id="summaryGoogle" class="text-green-400">âœ“ å·²é…ç½®</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-400">GitHub OAuth:</span>
                                <span id="summaryGitHub" class="text-green-400">âœ“ å·²é…ç½®</span>
                            </div>
                        </div>
                    </div>

                    <div class="bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-4">
                        <h3 class="font-bold text-yellow-300 mb-2">ğŸ”§ ä¸‹ä¸€æ­¥å»ºè®®</h3>
                        <ul class="text-gray-300 text-sm space-y-1">
                            <li>â€¢ æµ‹è¯•ç™»å…¥å’Œæ³¨å†ŒåŠŸèƒ½</li>
                            <li>â€¢ éªŒè¯ç¤¾äº¤ç™»å…¥æ˜¯å¦æ­£å¸¸å·¥ä½œ</li>
                            <li>â€¢ æ£€æŸ¥å¿˜è®°å¯†ç åŠŸèƒ½</li>
                            <li>â€¢ é…ç½®é‚®ä»¶æœåŠ¡ï¼ˆç”¨äºå¯†ç é‡ç½®ï¼‰</li>
                        </ul>
                    </div>

                    <div class="flex space-x-4">
                        <button onclick="prevStep()" class="flex-1 bg-gray-600 text-white font-bold py-3 rounded-lg hover:bg-gray-700 transition-colors">
                            è¿”å›ä¿®æ”¹
                        </button>
                        <a href="index.html" class="flex-1 gold-bg text-black font-bold py-3 rounded-lg hover:opacity-90 transition-opacity text-center">
                            å‰å¾€ç½‘ç«™é¦–é¡µ
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const totalSteps = 4;

        function updateStepIndicator() {
            document.querySelectorAll('.step').forEach((step, index) => {
                const stepNumber = index + 1;
                const circle = step.querySelector('div');
                
                if (stepNumber < currentStep) {
                    circle.className = 'w-10 h-10 rounded-full bg-green-500 flex items-center justify-center text-white font-bold mb-2';
                    circle.innerHTML = '<i class="fas fa-check"></i>';
                } else if (stepNumber === currentStep) {
                    circle.className = 'w-10 h-10 rounded-full gold-bg flex items-center justify-center text-black font-bold mb-2';
                    circle.textContent = stepNumber;
                } else {
                    circle.className = 'w-10 h-10 rounded-full bg-gray-600 flex items-center justify-center text-white font-bold mb-2';
                    circle.textContent = stepNumber;
                }
            });
        }

        function showStep(step) {
            document.querySelectorAll('.step-content').forEach(content => {
                content.classList.add('hidden');
            });
            document.getElementById(`step${step}`).classList.remove('hidden');
        }

        function nextStep() {
            if (currentStep < totalSteps) {
                if (currentStep === 1) {
                    saveApiConfig();
                } else if (currentStep === 2) {
                    saveGoogleConfig();
                } else if (currentStep === 3) {
                    saveGitHubConfig();
                    showConfigSummary();
                }
                
                currentStep++;
                showStep(currentStep);
                updateStepIndicator();
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
                updateStepIndicator();
            }
        }

        function saveApiConfig() {
            const apiUrl = document.getElementById('apiUrl').value || 'https://api.jiushiai.com';
            
            // æ›´æ–° api-config.js æ–‡ä»¶ï¼ˆè¿™é‡Œæ¼”ç¤ºå¦‚ä½•ç”Ÿæˆé…ç½®ï¼‰
            const config = {
                API_BASE_URL: apiUrl,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('jiushiai_api_config', JSON.stringify(config));
            console.log('âœ… APIé…ç½®å·²ä¿å­˜:', apiUrl);
        }

        function saveGoogleConfig() {
            const clientId = document.getElementById('googleClientId').value;
            
            if (clientId) {
                const config = JSON.parse(localStorage.getItem('jiushiai_oauth_config') || '{}');
                config.google = {
                    clientId: clientId,
                    enabled: true
                };
                localStorage.setItem('jiushiai_oauth_config', JSON.stringify(config));
                console.log('âœ… Google OAuthé…ç½®å·²ä¿å­˜');
            }
        }

        function saveGitHubConfig() {
            const clientId = document.getElementById('githubClientId').value;
            
            if (clientId) {
                const config = JSON.parse(localStorage.getItem('jiushiai_oauth_config') || '{}');
                config.github = {
                    clientId: clientId,
                    enabled: true
                };
                localStorage.setItem('jiushiai_oauth_config', JSON.stringify(config));
                console.log('âœ… GitHub OAuthé…ç½®å·²ä¿å­˜');
            }
        }

        function showConfigSummary() {
            const apiConfig = JSON.parse(localStorage.getItem('jiushiai_api_config') || '{}');
            const oauthConfig = JSON.parse(localStorage.getItem('jiushiai_oauth_config') || '{}');
            
            document.getElementById('summaryApiUrl').textContent = apiConfig.API_BASE_URL || 'https://api.jiushiai.com';
            
            const googleStatus = oauthConfig.google?.enabled ? 'âœ“ å·²é…ç½®' : 'âš ï¸ è·³è¿‡';
            const githubStatus = oauthConfig.github?.enabled ? 'âœ“ å·²é…ç½®' : 'âš ï¸ è·³è¿‡';
            
            document.getElementById('summaryGoogle').textContent = googleStatus;
            document.getElementById('summaryGoogle').className = oauthConfig.google?.enabled ? 'text-green-400' : 'text-yellow-400';
            
            document.getElementById('summaryGitHub').textContent = githubStatus;
            document.getElementById('summaryGitHub').className = oauthConfig.github?.enabled ? 'text-green-400' : 'text-yellow-400';
        }

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateStepIndicator();
            
            // æ£€æŸ¥æ˜¯å¦å·²æœ‰é…ç½®
            const apiConfig = localStorage.getItem('jiushiai_api_config');
            const oauthConfig = localStorage.getItem('jiushiai_oauth_config');
            
            if (apiConfig || oauthConfig) {
                const showExisting = confirm('æ£€æµ‹åˆ°å·²æœ‰é…ç½®ï¼Œæ˜¯å¦è¦é‡æ–°é…ç½®ï¼Ÿ\nç‚¹å‡»"ç¡®å®š"é‡æ–°é…ç½®ï¼Œç‚¹å‡»"å–æ¶ˆ"ç»§ç»­ä½¿ç”¨ç°æœ‰é…ç½®');
                if (!showExisting) {
                    window.location.href = 'index.html';
                    return;
                }
            }
            
            // è‡ªåŠ¨å¡«å……å½“å‰åŸŸå
            const origin = window.location.origin;
            document.querySelectorAll('code').forEach(code => {
                code.textContent = code.textContent.replace('${window.location.origin}', origin);
            });
        });

        // ç”Ÿæˆé…ç½®æ–‡ä»¶ä¸‹è½½
        function downloadConfig() {
            const apiConfig = JSON.parse(localStorage.getItem('jiushiai_api_config') || '{}');
            const oauthConfig = JSON.parse(localStorage.getItem('jiushiai_oauth_config') || '{}');
            
            const configContent = `// ä¹ç­® API é…ç½®
// è‡ªåŠ¨ç”Ÿæˆäº: ${new Date().toLocaleString()}

// è¯·å°†ä»¥ä¸‹é…ç½®æ›´æ–°åˆ° api-config.js æ–‡ä»¶ä¸­

const API_CONFIG = {
    BASE_URL: '${apiConfig.API_BASE_URL || 'https://api.jiushiai.com'}',
    
    OAUTH: {
        GOOGLE: {
            CLIENT_ID: '${oauthConfig.google?.clientId || 'ä½ çš„Googleå®¢æˆ·ç«¯ID'}',
        },
        GITHUB: {
            CLIENT_ID: '${oauthConfig.github?.clientId || 'ä½ çš„GitHubå®¢æˆ·ç«¯ID'}',
        }
    }
};`;

            const blob = new Blob([configContent], { type: 'text/javascript' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'api-config-generated.js';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
    </script>
</body>
</html>