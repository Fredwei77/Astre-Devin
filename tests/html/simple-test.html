<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®€å•æµ‹è¯• - Destiny AI</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
            background: #f0f0f0;
        }
        .box {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin: 10px 0;
        }
        button:hover {
            background: #45a049;
        }
        .result {
            background: #f9f9f9;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #4CAF50;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 14px;
        }
        .error {
            border-left-color: #f44336;
            color: #f44336;
        }
        .success {
            border-left-color: #4CAF50;
            color: #4CAF50;
        }
        h1 { color: #333; }
        h2 { color: #666; }
    </style>
</head>
<body>
    <h1>ğŸ§ª ç®€å•æµ‹è¯•å·¥å…·</h1>
    
    <div class="box">
        <h2>æ­¥éª¤ 1: æ£€æŸ¥æ–‡ä»¶åŠ è½½</h2>
        <div id="check" class="result">ç­‰å¾…æ£€æŸ¥...</div>
    </div>
    
    <div class="box">
        <h2>æ­¥éª¤ 2: æµ‹è¯•æ¨¡æ‹Ÿæ¨¡å¼</h2>
        <button onclick="runTest()">ç‚¹å‡»æµ‹è¯•</button>
        <div id="result"></div>
    </div>
    
    <!-- åŠ è½½è„šæœ¬ -->
    <script src="config.js"></script>
    <script src="ai-service.js"></script>
    
    <script>
        // æ£€æŸ¥æ–‡ä»¶åŠ è½½
        function checkLoading() {
            const checkDiv = document.getElementById('check');
            let html = '';
            
            if (typeof CONFIG !== 'undefined') {
                html += '<div class="success">âœ… CONFIG å·²åŠ è½½</div>';
                html += `<div>- API Key: ${CONFIG.OPENROUTER_API_KEY ? 'å·²é…ç½®' : 'æœªé…ç½®'}</div>`;
                html += `<div>- æ¨¡å‹: ${CONFIG.AI_MODEL}</div>`;
                html += `<div>- æ¨¡æ‹Ÿæ¨¡å¼: ${CONFIG.FEATURES.MOCK_MODE ? 'å¼€å¯' : 'å…³é—­'}</div>`;
            } else {
                html += '<div class="error">âŒ CONFIG æœªåŠ è½½</div>';
            }
            
            if (typeof AIService !== 'undefined') {
                html += '<div class="success">âœ… AIService å·²åŠ è½½</div>';
            } else {
                html += '<div class="error">âŒ AIService æœªåŠ è½½</div>';
            }
            
            if (typeof aiService !== 'undefined') {
                html += '<div class="success">âœ… aiService å®ä¾‹å·²åˆ›å»º</div>';
            } else {
                html += '<div class="error">âŒ aiService å®ä¾‹æœªåˆ›å»º</div>';
            }
            
            checkDiv.innerHTML = html;
        }
        
        // è¿è¡Œæµ‹è¯•
        async function runTest() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<div class="result">æµ‹è¯•ä¸­...</div>';
            
            try {
                // å¯ç”¨æ¨¡æ‹Ÿæ¨¡å¼
                CONFIG.FEATURES.MOCK_MODE = true;
                
                // é‡æ–°åˆ›å»ºå®ä¾‹
                window.aiService = new AIService();
                
                resultDiv.innerHTML += '<div class="result success">âœ… AI æœåŠ¡å·²åˆå§‹åŒ–ï¼ˆæ¨¡æ‹Ÿæ¨¡å¼ï¼‰</div>';
                
                // æµ‹è¯•å åœ
                resultDiv.innerHTML += '<div class="result">æ­£åœ¨æµ‹è¯•å åœåˆ†æ...</div>';
                
                const result = await aiService.analyzeDivination({
                    birthDate: '1990-01-01',
                    birthTime: '12:00',
                    birthPlace: 'Beijing',
                    gender: 'male',
                    categories: ['career', 'wealth']
                });
                
                resultDiv.innerHTML += '<div class="result success">âœ… å åœåˆ†ææˆåŠŸï¼</div>';
                resultDiv.innerHTML += `<div class="result">æ€§æ ¼ç‰¹ç‚¹: ${result.personality.slice(0, 2).join(', ')}...</div>`;
                resultDiv.innerHTML += `<div class="result">äº”è¡Œå¹³è¡¡: æœ¨${result.elements.wood} ç«${result.elements.fire} åœŸ${result.elements.earth} é‡‘${result.elements.metal} æ°´${result.elements.water}</div>`;
                resultDiv.innerHTML += `<div class="result">å¹¸è¿é¢œè‰²: ${result.luckyColors.join(', ')}</div>`;
                resultDiv.innerHTML += `<div class="result">å¹¸è¿æ•°å­—: ${result.luckyNumbers.join(', ')}</div>`;
                
                resultDiv.innerHTML += '<div class="result success">ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼åŠŸèƒ½æ­£å¸¸å·¥ä½œï¼</div>';
                
            } catch (error) {
                resultDiv.innerHTML += `<div class="result error">âŒ é”™è¯¯: ${error.message}</div>`;
                resultDiv.innerHTML += `<div class="result error">å †æ ˆ: ${error.stack}</div>`;
                console.error('æµ‹è¯•å¤±è´¥:', error);
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥
        window.addEventListener('DOMContentLoaded', () => {
            checkLoading();
        });
    </script>
</body>
</html>
