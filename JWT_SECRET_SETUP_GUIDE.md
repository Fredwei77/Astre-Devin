# ğŸ” JWT Secret é…ç½®æŒ‡å—

## ğŸ“‹ ä»€ä¹ˆæ˜¯ JWT Secretï¼Ÿ

JWT (JSON Web Token) Secret æ˜¯ç”¨äºç­¾åå’ŒéªŒè¯ JWT ä»¤ç‰Œçš„å¯†é’¥ã€‚å®ƒç¡®ä¿ï¼š
- ä»¤ç‰Œçš„çœŸå®æ€§
- é˜²æ­¢ä»¤ç‰Œè¢«ç¯¡æ”¹
- ç”¨æˆ·èº«ä»½éªŒè¯çš„å®‰å…¨æ€§

---

## ğŸš€ å¿«é€Ÿç”Ÿæˆ JWT Secret

### æ–¹å¼1: ä½¿ç”¨ç”Ÿæˆè„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# åŒå‡»è¿è¡Œ
generate-jwt-secret.bat

# æˆ–ä½¿ç”¨ Node.js
node generate-jwt-secret.js
```

è„šæœ¬ä¼šï¼š
1. âœ… ç”Ÿæˆ 128 å­—ç¬¦çš„éšæœºå¯†é’¥
2. âœ… æ˜¾ç¤ºä½¿ç”¨æ–¹æ³•
3. âœ… è‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼ˆWindowsï¼‰

### æ–¹å¼2: ä½¿ç”¨ Node.js å‘½ä»¤

```bash
node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
```

### æ–¹å¼3: ä½¿ç”¨ PowerShell

```powershell
[Convert]::ToBase64String((1..64 | ForEach-Object { Get-Random -Maximum 256 }))
```

### æ–¹å¼4: ä½¿ç”¨åœ¨çº¿å·¥å…·

è®¿é—®: https://randomkeygen.com/
é€‰æ‹© "CodeIgniter Encryption Keys" æˆ– "256-bit WEP Keys"

---

## ğŸ“ é…ç½® JWT Secret

### 1. æœ¬åœ°å¼€å‘ç¯å¢ƒ

åˆ›å»ºæˆ–ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
# JWT è®¤è¯å¯†é’¥
JWT_SECRET=your-generated-secret-key-here
```

**ç¤ºä¾‹**:
```env
JWT_SECRET=a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2g3h4i5j6k7l8m9n0o1p2q3r4s5t6u7v8w9x0y1z2a3b4c5d6e7f8g9h0i1j2k3l4m5n6o7p8
```

### 2. Railway éƒ¨ç½²

#### æ­¥éª¤1: ç”Ÿæˆå¯†é’¥
```bash
node generate-jwt-secret.js
```

#### æ­¥éª¤2: é…ç½® Railway

1. è®¿é—® Railway Dashboard
2. é€‰æ‹©ä½ çš„é¡¹ç›®
3. ç‚¹å‡» "Variables" æ ‡ç­¾
4. ç‚¹å‡» "New Variable"
5. æ·»åŠ ï¼š
   ```
   Key: JWT_SECRET
   Value: [ç²˜è´´ç”Ÿæˆçš„å¯†é’¥]
   ```
6. ç‚¹å‡» "Add"

#### æ­¥éª¤3: é‡æ–°éƒ¨ç½²

Railway ä¼šè‡ªåŠ¨é‡æ–°éƒ¨ç½²åº”ç”¨

### 3. Render éƒ¨ç½²

#### æ­¥éª¤1: ç”Ÿæˆå¯†é’¥
```bash
node generate-jwt-secret.js
```

#### æ­¥éª¤2: é…ç½® Render

1. è®¿é—® Render Dashboard
2. é€‰æ‹©ä½ çš„ Web Service
3. ç‚¹å‡» "Environment" æ ‡ç­¾
4. ç‚¹å‡» "Add Environment Variable"
5. æ·»åŠ ï¼š
   ```
   Key: JWT_SECRET
   Value: [ç²˜è´´ç”Ÿæˆçš„å¯†é’¥]
   ```
6. ç‚¹å‡» "Save Changes"

#### æ­¥éª¤3: é‡æ–°éƒ¨ç½²

Render ä¼šè‡ªåŠ¨é‡æ–°éƒ¨ç½²åº”ç”¨

### 4. Heroku éƒ¨ç½²

```bash
heroku config:set JWT_SECRET=your-generated-secret-key
```

---

## ğŸ” éªŒè¯é…ç½®

### 1. æœ¬åœ°éªŒè¯

åˆ›å»ºæµ‹è¯•æ–‡ä»¶ `test-jwt.js`:

```javascript
require('dotenv').config();

console.log('JWT_SECRET é…ç½®æ£€æŸ¥ï¼š');
console.log('');

if (process.env.JWT_SECRET) {
    console.log('âœ… JWT_SECRET å·²é…ç½®');
    console.log('é•¿åº¦:', process.env.JWT_SECRET.length, 'å­—ç¬¦');
    console.log('å‰10ä¸ªå­—ç¬¦:', process.env.JWT_SECRET.substring(0, 10) + '...');
} else {
    console.log('âŒ JWT_SECRET æœªé…ç½®');
}
```

è¿è¡Œæµ‹è¯•ï¼š
```bash
node test-jwt.js
```

### 2. åç«¯éªŒè¯

å¯åŠ¨æœåŠ¡å™¨åæ£€æŸ¥æ—¥å¿—ï¼š

```bash
npm start
```

åº”è¯¥çœ‹åˆ°ï¼š
```
âœ… JWT Secret configured
âœ… Server running on port 3000
```

### 3. API æµ‹è¯•

æµ‹è¯•ç™»å½•ç«¯ç‚¹ï¼š

```bash
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"password123"}'
```

æˆåŠŸå“åº”åº”åŒ…å« JWT token

---

## ğŸ”’ å®‰å…¨æœ€ä½³å®è·µ

### 1. å¯†é’¥å¼ºåº¦

âœ… **æ¨è**:
- è‡³å°‘ 64 å­—èŠ‚ï¼ˆ128 å­—ç¬¦ï¼‰
- ä½¿ç”¨åŠ å¯†å®‰å…¨çš„éšæœºç”Ÿæˆå™¨
- åŒ…å«å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦

âŒ **é¿å…**:
- çŸ­å¯†é’¥ï¼ˆ< 32 å­—ç¬¦ï¼‰
- å¯é¢„æµ‹çš„å¯†é’¥ï¼ˆå¦‚ "secret123"ï¼‰
- å­—å…¸å•è¯

### 2. å¯†é’¥ç®¡ç†

âœ… **åº”è¯¥åš**:
- ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨
- æ¯ä¸ªç¯å¢ƒä½¿ç”¨ä¸åŒå¯†é’¥
- å®šæœŸè½®æ¢å¯†é’¥ï¼ˆæ¯ 3-6 ä¸ªæœˆï¼‰
- å®‰å…¨å¤‡ä»½å¯†é’¥

âŒ **ä¸åº”è¯¥åš**:
- ç¡¬ç¼–ç åœ¨ä»£ç ä¸­
- æäº¤åˆ° Git
- åœ¨æ—¥å¿—ä¸­æ‰“å°
- é€šè¿‡ä¸å®‰å…¨æ¸ é“åˆ†äº«

### 3. å¯†é’¥è½®æ¢

å½“éœ€è¦æ›´æ¢å¯†é’¥æ—¶ï¼š

1. ç”Ÿæˆæ–°å¯†é’¥
2. åœ¨æœåŠ¡å™¨é…ç½®æ–°å¯†é’¥
3. é‡å¯æœåŠ¡å™¨
4. æ‰€æœ‰ç”¨æˆ·éœ€è¦é‡æ–°ç™»å½•
5. åˆ é™¤æ—§å¯†é’¥

---

## ğŸ“Š JWT Secret é…ç½®æ£€æŸ¥æ¸…å•

### ç”Ÿæˆé˜¶æ®µ
- [ ] ä½¿ç”¨å®‰å…¨çš„éšæœºç”Ÿæˆå™¨
- [ ] å¯†é’¥é•¿åº¦ â‰¥ 64 å­—èŠ‚
- [ ] å¯†é’¥å·²å¤åˆ¶ä¿å­˜

### é…ç½®é˜¶æ®µ
- [ ] æœ¬åœ° .env æ–‡ä»¶å·²é…ç½®
- [ ] Railway/Render ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] .env å·²æ·»åŠ åˆ° .gitignore
- [ ] å¯†é’¥æœªæäº¤åˆ° Git

### éªŒè¯é˜¶æ®µ
- [ ] æœ¬åœ°æµ‹è¯•é€šè¿‡
- [ ] æœåŠ¡å™¨å¯åŠ¨æˆåŠŸ
- [ ] JWT ç­¾åæ­£å¸¸å·¥ä½œ
- [ ] ç™»å½•åŠŸèƒ½æ­£å¸¸

### å®‰å…¨é˜¶æ®µ
- [ ] å¯†é’¥å·²å®‰å…¨å­˜å‚¨
- [ ] å›¢é˜Ÿæˆå‘˜å·²çŸ¥æ™“
- [ ] å¤‡ä»½å·²åˆ›å»º
- [ ] è½®æ¢è®¡åˆ’å·²åˆ¶å®š

---

## ğŸš¨ å¸¸è§é—®é¢˜

### Q: JWT_SECRET åº”è¯¥å¤šé•¿ï¼Ÿ

A: æ¨èè‡³å°‘ 64 å­—èŠ‚ï¼ˆ128 å­—ç¬¦ï¼‰ã€‚æˆ‘ä»¬çš„ç”Ÿæˆå™¨é»˜è®¤ç”Ÿæˆ 128 å­—ç¬¦çš„å¯†é’¥ã€‚

### Q: å¯ä»¥ä½¿ç”¨ç®€å•çš„å¯†ç å—ï¼Ÿ

A: ä¸å¯ä»¥ï¼å¿…é¡»ä½¿ç”¨åŠ å¯†å®‰å…¨çš„éšæœºå¯†é’¥ã€‚ç®€å•å¯†ç å®¹æ˜“è¢«ç ´è§£ã€‚

### Q: éœ€è¦ä¸ºæ¯ä¸ªç¯å¢ƒä½¿ç”¨ä¸åŒçš„å¯†é’¥å—ï¼Ÿ

A: æ˜¯çš„ï¼å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒåº”è¯¥ä½¿ç”¨ä¸åŒçš„å¯†é’¥ã€‚

### Q: å¦‚ä½•æ›´æ¢ JWT_SECRETï¼Ÿ

A: 
1. ç”Ÿæˆæ–°å¯†é’¥
2. æ›´æ–°ç¯å¢ƒå˜é‡
3. é‡å¯æœåŠ¡å™¨
4. æ³¨æ„ï¼šæ‰€æœ‰ç°æœ‰ token å°†å¤±æ•ˆï¼Œç”¨æˆ·éœ€è¦é‡æ–°ç™»å½•

### Q: JWT_SECRET æ³„éœ²äº†æ€ä¹ˆåŠï¼Ÿ

A: ç«‹å³ï¼š
1. ç”Ÿæˆæ–°å¯†é’¥
2. æ›´æ–°æ‰€æœ‰ç¯å¢ƒ
3. é‡å¯æœåŠ¡å™¨
4. é€šçŸ¥ç”¨æˆ·é‡æ–°ç™»å½•
5. å®¡æŸ¥å®‰å…¨æ—¥å¿—

### Q: å¯ä»¥åœ¨å‰ç«¯ä½¿ç”¨ JWT_SECRET å—ï¼Ÿ

A: ç»å¯¹ä¸å¯ä»¥ï¼JWT_SECRET åªèƒ½åœ¨åç«¯ä½¿ç”¨ï¼Œæ°¸è¿œä¸è¦æš´éœ²ç»™å‰ç«¯ã€‚

---

## ğŸ“ å®Œæ•´é…ç½®ç¤ºä¾‹

### .env æ–‡ä»¶ï¼ˆæœ¬åœ°å¼€å‘ï¼‰

```env
# ============================================
# JWT é…ç½®
# ============================================

# JWT ç­¾åå¯†é’¥ï¼ˆå¿…éœ€ï¼‰
JWT_SECRET=a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2

# JWT è¿‡æœŸæ—¶é—´ï¼ˆå¯é€‰ï¼‰
JWT_EXPIRES_IN=24h

# JWT åˆ·æ–°ä»¤ç‰Œè¿‡æœŸæ—¶é—´ï¼ˆå¯é€‰ï¼‰
JWT_REFRESH_EXPIRES_IN=7d

# ============================================
# å…¶ä»–ç¯å¢ƒå˜é‡
# ============================================

NODE_ENV=development
PORT=3000
FRONTEND_URL=http://localhost:8080
```

### Railway ç¯å¢ƒå˜é‡

```
JWT_SECRET=a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0u1v2w3x4y5z6a7b8c9d0e1f2
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥

### é…ç½®å®Œæˆå

1. **éªŒè¯é…ç½®**
   - [ ] è¿è¡Œ `node test-jwt.js`
   - [ ] å¯åŠ¨æœåŠ¡å™¨
   - [ ] æµ‹è¯•ç™»å½•åŠŸèƒ½

2. **éƒ¨ç½²åˆ°ç”Ÿäº§**
   - [ ] åœ¨ Railway/Render é…ç½®
   - [ ] é‡æ–°éƒ¨ç½²åº”ç”¨
   - [ ] æµ‹è¯•ç”Ÿäº§ç¯å¢ƒ

3. **æ–‡æ¡£è®°å½•**
   - [ ] è®°å½•å¯†é’¥ä½ç½®
   - [ ] è®°å½•è½®æ¢è®¡åˆ’
   - [ ] æ›´æ–°å›¢é˜Ÿæ–‡æ¡£

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

### ç”Ÿæˆå¯†é’¥
```bash
# è¿è¡Œç”Ÿæˆå™¨
generate-jwt-secret.bat

# æˆ–ä½¿ç”¨ Node.js
node generate-jwt-secret.js
```

### æµ‹è¯•é…ç½®
```bash
# æµ‹è¯•æœ¬åœ°é…ç½®
node test-jwt.js

# å¯åŠ¨æœåŠ¡å™¨
npm start
```

### æŸ¥çœ‹æ–‡æ¡£
- [JWT å®˜æ–¹æ–‡æ¡£](https://jwt.io)
- [Node.js Crypto](https://nodejs.org/api/crypto.html)
- [ç¯å¢ƒå˜é‡æœ€ä½³å®è·µ](https://12factor.net/config)

---

**å‡†å¤‡å¥½é…ç½® JWT Secret äº†å—ï¼Ÿè¿è¡Œ `generate-jwt-secret.bat` å¼€å§‹ï¼** ğŸ”

---

*æœ€åæ›´æ–°: 2024-12-08*
