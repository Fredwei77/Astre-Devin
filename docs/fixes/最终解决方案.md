# ğŸ¯ Stripe æ”¯ä»˜ - æœ€ç»ˆè§£å†³æ–¹æ¡ˆ

## é—®é¢˜æ ¹æº

**CORS é—®é¢˜**ï¼šç›´æ¥ä»æ–‡ä»¶ç³»ç»Ÿæ‰“å¼€ HTML æ–‡ä»¶ï¼ˆ`file://` åè®®ï¼‰æ— æ³•è®¿é—® `http://localhost:3000` çš„ APIã€‚

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ³• 1: é€šè¿‡æœåŠ¡å™¨è®¿é—®ï¼ˆæ¨èï¼‰

ä¸è¦ç›´æ¥åŒå‡»æ‰“å¼€ HTML æ–‡ä»¶ï¼Œè€Œæ˜¯é€šè¿‡æœåŠ¡å™¨è®¿é—®ï¼š

```
http://localhost:3000/test-stripe-api.html
```

### æ–¹æ³• 2: ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬

```bash
åŒå‡»è¿è¡Œ: final-test.bat
```

è¿™å°†ï¼š
1. é‡å¯æœåŠ¡å™¨
2. ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨
3. è‡ªåŠ¨åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://localhost:3000/test-stripe-api.html`

---

## ğŸš€ ç«‹å³æµ‹è¯•

### æ­¥éª¤ 1: è¿è¡Œè„šæœ¬

```bash
åŒå‡»: final-test.bat
```

### æ­¥éª¤ 2: åœ¨æµè§ˆå™¨ä¸­æµ‹è¯•

æµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€ `http://localhost:3000/test-stripe-api.html`

ç‚¹å‡»æµ‹è¯•æŒ‰é’®ï¼š
1. **æµ‹è¯•æœåŠ¡å™¨** - åº”è¯¥æ˜¾ç¤º âœ… æˆåŠŸ
2. **æµ‹è¯•æ”¯ä»˜ API** - åº”è¯¥æ˜¾ç¤º âœ… æˆåŠŸ

---

## ğŸ“‹ æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤

å¦‚æœè‡ªåŠ¨åŒ–è„šæœ¬ä¸å·¥ä½œï¼š

### 1. ç¡®ä¿æœåŠ¡å™¨è¿è¡Œ

```bash
npm start
```

ç­‰å¾…çœ‹åˆ°ï¼š
```
âœ… Stripe åˆå§‹åŒ–æˆåŠŸ
ğŸš€ Destiny AI Server running on port 3000
```

### 2. åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€

**é‡è¦**ï¼šä¸è¦ç›´æ¥åŒå‡» HTML æ–‡ä»¶ï¼

åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ï¼š
```
http://localhost:3000/test-stripe-api.html
```

### 3. æµ‹è¯• API

ç‚¹å‡»"æµ‹è¯•æ”¯ä»˜ API"æŒ‰é’®ï¼Œåº”è¯¥çœ‹åˆ°ï¼š

```json
âœ… æ”¯ä»˜æ„å›¾åˆ›å»ºæˆåŠŸ
{
  "status": 200,
  "paymentIntentId": "pi_xxx",
  "clientSecret": "pi_xxx_secret_xxx...",
  "amount": 10,
  "currency": "USD"
}
```

---

## ğŸ” éªŒè¯æ¸…å•

- [ ] æœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼ˆ`npm start`ï¼‰
- [ ] æœåŠ¡å™¨æ˜¾ç¤º "âœ… Stripe åˆå§‹åŒ–æˆåŠŸ"
- [ ] é€šè¿‡ `http://localhost:3000` è®¿é—®ï¼Œä¸æ˜¯ `file://`
- [ ] Stripe SDK å·²å®‰è£…ï¼ˆ`npm list stripe`ï¼‰
- [ ] .env ä¸­æœ‰ `STRIPE_SECRET_KEY`

---

## âš ï¸ å¸¸è§é”™è¯¯

### é”™è¯¯ 1: "Failed to fetch"

**åŸå› **: ç›´æ¥æ‰“å¼€ HTML æ–‡ä»¶ï¼ˆ`file://` åè®®ï¼‰

**è§£å†³**: 
```
é€šè¿‡æœåŠ¡å™¨è®¿é—®: http://localhost:3000/test-stripe-api.html
```

### é”™è¯¯ 2: "Stripe æœªåˆå§‹åŒ–"

**åŸå› **: Stripe SDK æœªå®‰è£…æˆ–å¯†é’¥æœªé…ç½®

**è§£å†³**:
```bash
npm install stripe --save
```

æ£€æŸ¥ `.env`:
```
STRIPE_SECRET_KEY=sk_test_51SXG0rPyLPASs4oM...
```

### é”™è¯¯ 3: "Cannot GET /test-stripe-api.html"

**åŸå› **: é™æ€æ–‡ä»¶æœåŠ¡é…ç½®é—®é¢˜

**è§£å†³**: å·²ä¿®å¤ï¼Œserver.js ç°åœ¨æœåŠ¡å½“å‰ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶

---

## ğŸ¯ å®Œæ•´æµ‹è¯•æµç¨‹

### A. ä½¿ç”¨è‡ªåŠ¨åŒ–è„šæœ¬ï¼ˆæœ€ç®€å•ï¼‰

```bash
1. åŒå‡»: final-test.bat
2. ç­‰å¾…æµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€
3. ç‚¹å‡»æµ‹è¯•æŒ‰é’®
```

### B. æ‰‹åŠ¨æµ‹è¯•

```bash
1. æ‰“å¼€ç»ˆç«¯
2. è¿è¡Œ: npm start
3. ç­‰å¾…æœåŠ¡å™¨å¯åŠ¨
4. æ‰“å¼€æµè§ˆå™¨
5. è®¿é—®: http://localhost:3000/test-stripe-api.html
6. ç‚¹å‡»æµ‹è¯•æŒ‰é’®
```

---

## ğŸ“Š æˆåŠŸæ ‡å¿—

### æœåŠ¡å™¨ç»ˆç«¯

```
âœ… Stripe åˆå§‹åŒ–æˆåŠŸ
ğŸš€ Destiny AI Server running on port 3000
ğŸ“ Environment: development
ğŸ”’ CORS enabled for: http://localhost:8080
```

### æµè§ˆå™¨æµ‹è¯•é¡µé¢

```
âœ… æœåŠ¡å™¨è¿æ¥æˆåŠŸ
{
  "status": 200,
  "data": {
    "status": "ok",
    "timestamp": "2024-..."
  }
}

âœ… æ”¯ä»˜æ„å›¾åˆ›å»ºæˆåŠŸ
{
  "status": 200,
  "paymentIntentId": "pi_xxx",
  "clientSecret": "pi_xxx_secret_xxx...",
  "amount": 10,
  "currency": "USD"
}
```

---

## ğŸ”§ æ•…éšœæ’é™¤

### å¦‚æœæœåŠ¡å™¨æ— æ³•å¯åŠ¨

1. æ£€æŸ¥ç«¯å£æ˜¯å¦è¢«å ç”¨ï¼š
   ```bash
   netstat -ano | findstr :3000
   ```

2. åœæ­¢å ç”¨ç«¯å£çš„è¿›ç¨‹ï¼š
   ```bash
   taskkill /F /PID <è¿›ç¨‹ID>
   ```

3. é‡æ–°å¯åŠ¨ï¼š
   ```bash
   npm start
   ```

### å¦‚æœ Stripe åˆå§‹åŒ–å¤±è´¥

1. å®‰è£… Stripeï¼š
   ```bash
   npm install stripe --save
   ```

2. æ£€æŸ¥ .env é…ç½®ï¼š
   ```bash
   type .env | findstr STRIPE
   ```

3. é‡å¯æœåŠ¡å™¨

### å¦‚æœä»ç„¶å¤±è´¥

1. æŸ¥çœ‹æœåŠ¡å™¨ç»ˆç«¯çš„å®Œæ•´é”™è¯¯ä¿¡æ¯
2. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰çš„é”™è¯¯
3. ç¡®è®¤é€šè¿‡ `http://localhost:3000` è®¿é—®ï¼Œä¸æ˜¯ `file://`

---

## âœ¨ ä¸‹ä¸€æ­¥

æµ‹è¯•æˆåŠŸåï¼š

1. **æµ‹è¯•å®Œæ•´æ”¯ä»˜æµç¨‹**
   ```
   http://localhost:3000/test-stripe-payment.html
   ```

2. **æµ‹è¯•ä¼šå‘˜è®¢é˜…**
   - ä½¿ç”¨æµ‹è¯•å¡å·: `4242 4242 4242 4242`
   - è¿‡æœŸæ—¥æœŸ: `12/34`
   - CVC: `123`

3. **é›†æˆåˆ°å®é™…é¡µé¢**
   - æ›´æ–° `payment.html`
   - æ·»åŠ æ”¯ä»˜æŒ‰é’®
   - æµ‹è¯•å®Œæ•´è´­ç‰©æµç¨‹

---

## ğŸ“ å…³é”®è¦ç‚¹

1. âœ… **å¿…é¡»é€šè¿‡æœåŠ¡å™¨è®¿é—®**ï¼š`http://localhost:3000/xxx.html`
2. âœ… **ä¸è¦ç›´æ¥æ‰“å¼€ HTML æ–‡ä»¶**ï¼šé¿å… CORS é—®é¢˜
3. âœ… **ä½¿ç”¨ final-test.bat**ï¼šè‡ªåŠ¨åŒ–æµ‹è¯•æµç¨‹
4. âœ… **æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—**ï¼šç¡®è®¤ Stripe åˆå§‹åŒ–æˆåŠŸ

---

## ğŸ‰ æ€»ç»“

**é—®é¢˜**: CORS å¯¼è‡´æ— æ³•è®¿é—® API

**è§£å†³**: é€šè¿‡æœåŠ¡å™¨è®¿é—®æµ‹è¯•é¡µé¢

**å‘½ä»¤**: `final-test.bat` æˆ–è®¿é—® `http://localhost:3000/test-stripe-api.html`

**ç«‹å³å¼€å§‹**: åŒå‡»è¿è¡Œ `final-test.bat`ï¼
