# 🛍️ 风水商店快速设置指南

## 第一步：创建数据库表

### 方法 1: 使用 Supabase Dashboard

1. 登录 [Supabase Dashboard](https://app.supabase.com)
2. 选择你的项目
3. 点击左侧菜单 "SQL Editor"
4. 点击 "New Query"
5. 复制 `supabase-shop-schema.sql` 的全部内容
6. 粘贴到编辑器
7. 点击 "Run" 执行

### 验证表创建成功

在 SQL Editor 中运行：
```sql
SELECT table_name 
FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_name IN ('products', 'cart_items', 'orders', 'order_items', 'shipping_addresses');
```

应该看到 5 个表。

## 第二步：验证示例数据

运行以下查询查看示例商品：
```sql
SELECT * FROM products;
```

应该看到 6 个商品：
- 龙雕像
- 水晶球
- 祈福手环
- 罗盘
- 八卦镜
- 五帝钱币

## 第三步：测试前端功能

### 启动服务器

```bash
# 如果还没启动服务器
start.bat
```

### 测试商店页面

1. 访问: http://localhost:8000/fengshui.html
2. 滚动到"Feng Shui Items Shop"部分
3. 应该看到商品列表

### 测试购物功能

#### 测试 1: 添加到购物车
1. 点击任意商品的"加入购物车"按钮
2. 如果未登录，会跳转到登录页面
3. 登录后，应该看到"已添加到购物车"提示
4. 购物车图标上的数字应该增加

#### 测试 2: 查看购物车
1. 点击右上角的购物车图标
2. 应该看到购物车模态框
3. 可以修改数量（+/-按钮）
4. 可以删除商品（垃圾桶图标）

#### 测试 3: 立即购买
1. 点击任意商品的"立即购买"按钮
2. 应该直接进入结算页面
3. 填写收货信息
4. 点击"确认下单"

#### 测试 4: 购物车结算
1. 添加多个商品到购物车
2. 点击购物车图标
3. 点击"去结算"
4. 填写收货信息
5. 确认订单

## 第四步：测试管理后台

### 访问管理后台

访问: http://localhost:8000/admin-shop.html

### 测试商品管理

#### 添加新商品：
1. 填写商品信息
2. 点击"保存商品"
3. 应该在下方商品列表中看到新商品

#### 编辑商品：
1. 点击商品的"编辑"按钮
2. 修改信息
3. 点击"保存商品"

#### 删除商品：
1. 点击商品的"删除"按钮
2. 确认删除

### 测试订单管理

1. 在前端创建几个测试订单
2. 刷新管理后台
3. 应该在"订单管理"部分看到订单
4. 尝试更改订单状态

## 第五步：验证数据库记录

### 查看购物车记录

```sql
SELECT 
    c.*,
    p.name,
    p.price
FROM cart_items c
JOIN products p ON c.product_id = p.id;
```

### 查看订单记录

```sql
SELECT 
    o.*,
    COUNT(oi.id) as item_count
FROM orders o
LEFT JOIN order_items oi ON o.id = oi.order_id
GROUP BY o.id
ORDER BY o.created_at DESC;
```

### 查看订单详情

```sql
SELECT 
    o.order_number,
    o.status,
    o.total_amount,
    oi.product_name,
    oi.quantity,
    oi.subtotal
FROM orders o
JOIN order_items oi ON o.id = oi.order_id
ORDER BY o.created_at DESC;
```

## 🎯 快速测试清单

- [ ] 数据库表已创建
- [ ] 示例商品已加载
- [ ] 可以浏览商品列表
- [ ] 可以添加到购物车
- [ ] 购物车数量正确显示
- [ ] 可以查看购物车
- [ ] 可以修改购物车数量
- [ ] 可以删除购物车商品
- [ ] 可以立即购买
- [ ] 可以从购物车结算
- [ ] 订单创建成功
- [ ] 管理后台可以访问
- [ ] 可以添加/编辑商品
- [ ] 可以查看订单
- [ ] 可以更新订单状态

## 🐛 常见问题

### Q: 商品列表不显示？
A: 检查：
1. Supabase 连接是否正常
2. products 表是否有数据
3. RLS 策略是否正确

### Q: 添加到购物车失败？
A: 检查：
1. 用户是否已登录
2. cart_items 表的 RLS 策略
3. 浏览器控制台错误信息

### Q: 订单创建失败？
A: 检查：
1. 收货信息是否完整
2. orders 表的 RLS 策略
3. 订单号生成函数是否存在

### Q: 管理后台无法保存？
A: 检查：
1. 用户权限
2. 表单字段是否完整
3. 数据类型是否匹配

## 📞 需要帮助？

如果遇到问题：
1. 查看浏览器控制台 (F12)
2. 查看 Supabase Dashboard 的 Logs
3. 检查网络请求 (Network tab)
4. 验证数据库表结构

## 🎉 完成！

如果所有测试都通过，恭喜你！风水商店系统已经成功部署。

现在你可以：
- 添加更多商品
- 自定义商品分类
- 集成支付系统
- 添加更多功能

祝生意兴隆！🎊
