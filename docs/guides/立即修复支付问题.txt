========================================
Stripe 支付失败 - 立即修复
========================================

问题: 支付失败 - Failed to fetch
原因: API 路由未正确加载

========================================
快速修复（3步）
========================================

步骤 1: 运行重启脚本
   双击: restart-and-test.bat

步骤 2: 查看测试结果
   - 如果显示 ✅ 服务器连接成功
   - 如果显示 ✅ 支付意图创建成功
   - 说明修复成功！

步骤 3: 重新测试支付
   打开: test-stripe-payment.html
   使用测试卡号: 4242 4242 4242 4242

========================================
如果仍然失败
========================================

方法 1: 手动重启
1. 停止服务器 (Ctrl+C 或关闭终端)
2. 重新启动: npm start
3. 等待 5 秒
4. 打开: test-stripe-api.html

方法 2: 完整修复
1. 运行: fix-stripe-payment.bat
2. 按照提示操作
3. 查看诊断结果

方法 3: 检查配置
1. 确认 .env 中有 STRIPE_SECRET_KEY
2. 确认 stripe-api.js 文件存在
3. 确认 server.js 中有 Stripe 路由配置

========================================
测试工具
========================================

test-stripe-api.html
- 直接测试 API 连接
- 显示详细错误信息
- 推荐使用！

diagnose-stripe.html
- 完整诊断工具
- 检查所有配置
- 提供修复建议

test-stripe-payment.html
- 完整支付测试
- 包含 Stripe 卡片元素
- 模拟真实支付流程

========================================
常见错误
========================================

错误: Failed to fetch
解决: 重启服务器

错误: 接口不存在
解决: 检查 stripe-api.js 是否正确加载

错误: Invalid API Key
解决: 检查 .env 中的 STRIPE_SECRET_KEY

错误: Cannot find module 'stripe'
解决: npm install stripe --save

========================================
验证修复
========================================

✅ test-stripe-api.html 显示成功
✅ 可以创建支付意图
✅ 返回 clientSecret
✅ 没有错误信息

========================================
下一步
========================================

修复成功后:
1. 测试会员订阅
2. 测试商品购买
3. 集成到实际页面

========================================
获取帮助
========================================

查看详细文档:
- Stripe支付故障排除.md
- STRIPE_集成完成.md

运行诊断:
- diagnose-stripe.html
- test-stripe-api.html

========================================
✨ 立即开始修复
========================================

双击运行: restart-and-test.bat
